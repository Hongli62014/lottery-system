import{s as t}from"./chunk-CsYshFua.js";import{u as a}from"./chunk-B6HHG8fs.js";import{r as l,u as e,w as o}from"./chunk-C5xT2hrF.js";import{_ as n}from"./chunk-DIvd-FVQ.js";import{u as s,i,a as r}from"./chunk-DGX8FLOK.js";import{r as p}from"./chunk-Dv7RK_ed.js";import{a6 as d,r as c,a as m,W as b,X as u,bg as g,u as h,a3 as f,F as k,aS as y}from"./chunk-DItFX9tw.js";import"./chunk-CktjyfsX.js";import"./chunk-DHt_odDz.js";import"./chunk-ClxWGSjw.js";import"./chunk-DsPhSQSX.js";import"./chunk-COJDRNUs.js";import"./chunk-CZEL8Rot.js";import"./chunk-q-ZagYLw.js";import"./chunk-VPk9p_S4.js";import"./chunk-DezxjiP8.js";import"./chunk-DNiUIIzL.js";import"./chunk-BvWJbea5.js";import"./chunk-T1cRhSFL.js";import"./chunk-DbPkkXUs.js";import"./chunk-BcwQrg-K.js";import"./chunk-B-qLbzZm.js";import"./chunk-DUzMzk5W.js";const j={class:"modal-box"},x={class:"text-lg font-bold"},v={class:"py-4"},_={class:"modal-action"},A={method:"dialog",class:"flex gap-3"},N={class:"modal-box"},w={class:"text-lg font-bold"},T={class:"py-4"},C={class:"modal-action"},P={method:"dialog",class:"flex gap-3"},W={class:"min-w-1000px"},z={class:"flex gap-3"},D=["data-tip"],S=["download","href"],J={class:""},M={for:"explore"},O=["data-tip"],L={class:"btn btn-primary btn-sm"},R=d({__name:"PersonAll",setup(d){const{t:R}=a(),V=s().personConfig,{getAllPersonList:q,getAlreadyPersonList:E}=t(V),F=c(),I=c();async function X(t){const a=await p(t.target.files[0]),o=l(a,{type:"binary",cellDates:!0}),n=o.Sheets[o.SheetNames[0]],s=e.sheet_to_json(n),i=r(s);V.resetPerson(),V.addNotPersonList(i)}function B(){let t=JSON.parse(JSON.stringify(q.value));for(let l=0;l<t.length;l++)delete t[l].x,delete t[l].y,delete t[l].id,delete t[l].createTime,delete t[l].updateTime,delete t[l].prizeId,t[l].isWin?t[l].isWin=i.global.t("data.yes"):t[l].isWin=i.global.t("data.no"),t[l].prizeTime=t[l].prizeTime.join(","),t[l].prizeName=t[l].prizeName.join(",");let a=JSON.stringify(t);if(a=a.replaceAll(/uid/g,i.global.t("data.number")).replaceAll(/isWin/g,i.global.t("data.isWin")).replaceAll(/department/g,i.global.t("data.department")).replaceAll(/name/g,i.global.t("data.name")).replaceAll(/identity/g,i.global.t("data.identity")).replaceAll(/prizeName/g,i.global.t("data.prizeName")).replaceAll(/prizeTime/g,i.global.t("data.prizeTime")),t=JSON.parse(a),t.length>0){const a=e.json_to_sheet(t),l=e.book_new();e.book_append_sheet(l,a,"Sheet1"),o(l,"data.xlsx")}}function G(){V.resetAlreadyPerson()}function H(){V.deleteAllPerson()}const K=[{label:i.global.t("data.number"),props:"uid"},{label:i.global.t("data.name"),props:"name"},{label:i.global.t("data.department"),props:"department"},{label:i.global.t("data.avatar"),props:"avatar",formatValue:t=>t.avatar?'<img src="'.concat(t.avatar,'" alt="avatar" style="width: 50px; height: 50px;"/>'):"-"},{label:i.global.t("data.identity"),props:"identity"},{label:i.global.t("data.isWin"),props:"isWin",formatValue:t=>t.isWin?i.global.t("data.yes"):i.global.t("data.no")},{label:i.global.t("data.operation"),actions:[{label:i.global.t("data.delete"),type:"btn-error",onClick:t=>{!function(t){V.deletePerson(t)}(t)}}]}];return m(()=>{}),(t,a)=>(y(),b(k,null,[u("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:F,class:"border-none modal"},[u("div",j,[u("h3",x,g(h(R)("dialog.titleTip")),1),u("p",v,g(h(R)("dialog.dialogResetWinner")),1),u("div",_,[u("form",A,[u("button",{class:"btn",onClick:a[0]||(a[0]=t=>F.value.close())},g(h(R)("button.cancel")),1),u("button",{class:"btn",onClick:G},g(h(R)("button.confirm")),1)])])])],512),u("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:I,class:"border-none modal"},[u("div",N,[u("h3",w,g(h(R)("dialog.titleTip")),1),u("p",T,g(h(R)("dialog.dialogDelAllPerson")),1),u("div",C,[u("form",P,[u("button",{class:"btn",onClick:a[1]||(a[1]=t=>I.value.close())},g(h(R)("button.cancel")),1),u("button",{class:"btn",onClick:H},g(h(R)("button.confirm")),1)])])])],512),u("div",W,[u("h2",null,g(h(R)("viewTitle.personManagement")),1),u("div",z,[u("button",{class:"btn btn-error btn-sm",onClick:a[2]||(a[2]=t=>I.value.showModal())},g(h(R)("button.allDelete")),1),u("div",{class:"tooltip tooltip-bottom","data-tip":h(R)("tooltip.downloadTemplateTip")},[u("a",{class:"no-underline btn btn-secondary btn-sm",download:h(R)("data.xlsxName"),target:"_blank",href:"/log-lottery/".concat(h(R)("data.xlsxName"))},g(h(R)("button.downloadTemplate")),9,S)],8,D),u("div",J,[u("label",M,[u("div",{class:"tooltip tooltip-bottom","data-tip":h(R)("tooltip.uploadExcelTip")},[u("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:X},null,32),u("span",L,g(h(R)("button.importData")),1)],8,O)])]),u("button",{class:"btn btn-error btn-sm",onClick:a[3]||(a[3]=t=>F.value.showModal())},g(h(R)("button.resetData")),1),u("button",{class:"btn btn-accent btn-sm",onClick:B},g(h(R)("button.exportResult")),1),u("div",null,[u("span",null,g(h(R)("table.luckyPeopleNumber"))+":",1),u("span",null,g(h(E).length),1),a[4]||(a[4]=u("span",null," / ",-1)),u("span",null,g(h(q).length),1)])]),f(n,{"table-columns":K,data:h(q)},null,8,["data"])])],64))}});export{R as default};
